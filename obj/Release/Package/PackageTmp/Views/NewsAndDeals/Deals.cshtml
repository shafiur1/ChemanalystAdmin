
@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
    <head>
        <link href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css" rel="stylesheet" />
        <link href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.bootstrap.min.css" rel="stylesheet" />
        <script src="https//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap4.min.js "></script>
        <script src="~/js/date.format.js"></script>
        <script>

            $(document).ready(function () {
                $('#role').DataTable({
                    "ajax": {
                        "url": "../NewsAndDeals/DealsList",
                        "type": "GET",
                        "datatype": "json"
                    },
                    fields: [{
                        label: 'CreatedTime:',

                    }],
                    "columnDefs": [

                        {
                            "targets": [0],
                            "visible": false
                        }
                    ],
                    "columns": [
                        { "data": "id" },
                        { "data": "DealsName" },
                         { "data": "CreatedBy" },
                        //{ "data": "DealsDiscription" },
                        {
                            "data": "CreatedTime", type: "datetime",
                             "render": function (data) {
                                var nowDate = new Date(parseInt(data.substr(6)));
                                var result = "";
                                result += nowDate.format("mmm-dd-yy HH:MM:ss");
                                return result;
                            }

                        },
                        {

                            "render": function (data, type, row, meta) {
                                //return '<button type="button" class="btn btn-success">Approved</button>';
                                debugger
                                if (row.status == 1) {
                                    return '<button type="button" class="btn btn-success" id="btnStatus" onclick="UpdateStatus(' + row.id + ')">Approved</button>';
                                }
                                else {
                                    return '<button type="button" class="btn btn-danger" id="btnStatus" onclick="UpdateStatus(' + row.id + ')">Disapprove</button>';
                                }
                            }
                        },
                         {

                            "render": function (data, type, row, meta) { return '<a href="../NewsAndDeals/EditDeals/' + row.id + '"><i class="fa fa-pencil-square-o"></i></a>'; }
                        },
                        @if (ChemAnalyst.Common.Helpers.Global.AdminRole == Convert.ToString(Session["UserRole"]))
                    {<text>
                       
                        {
                            data: null, render: function (data, type, row) {
                                return '<a href="../NewsAndDeals/DeleteDeals/' + row.id + '"><i class="fa fa-trash-o fa-lg"></i></a>';
                            }
                        },
                   </text>
                    }
                    ]
                });
            });

            function UpdateStatus(dealId) {
                $.ajax({
                    url: "UpdateDealStatus",
                    type: "POST",
                    data: { dealId: dealId },
                    cache: false,
                    async: true,
                    success: function (data) {
                        window.location.reload(true);
                    }

                })
            }
        </script>
    </head>







<div class="update-profile-wrapper">

    <h3><a href="@Url.Action("AddDeals", "NewsAndDeals")" class="btn btn-success"><i class="fa fa-plus"></i> Add New Deals</a></h3>



    <div class="white-wrapper" style="padding-top:10px">

        <div class="data-detail-wrapper table-responsive">

            <table id="role" class="table table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Created by</th>
                        @*<th>description</th>*@
                        <th>Created</th>
                        <th>Status</th>
                        <th>Edit</th>
                        @if (ChemAnalyst.Common.Helpers.Global.AdminRole == Convert.ToString(Session["UserRole"]))
                        {

                            <th>Delete</th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @*@foreach (var role in Model)
                        {
                        <tr>

                          <td>@role.Role</td>
                          <td>@role.RoleDiscription </td>
                          <td>@role.CreatedTime</td>
                          <td><button type="button" class="btn btn-success">
                            Approved</button></td>
                          <td><a href="hedit-user/26"><i class="fa fa-pencil-square-o"></i></a></td>
                          <td><a site_url=" onclick="deleteUser(26)" href="javascript:void(0)"><i class="fa fa-trash-o fa-lg"></i></a></td>
                        </tr>
                        }*@



                </tbody>
            </table>



        </div>

    </div>

</div>





