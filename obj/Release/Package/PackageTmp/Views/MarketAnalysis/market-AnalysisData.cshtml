@model ChemAnalyst.ViewModel.DealsDetailsViewModel
@{

    var Product = Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.product);
    var ChartType = Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.ChartType);
    var range = Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.range);
    var Category = Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.Category);


}
@{
    var headerData = ChemAnalyst.DAL.ProductDataStore.GetHeaderData();
}
<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, shrink-to-fit=no">

    <title>Chem Analyst</title>

    <link href="~/css/oswald-font.css" rel="stylesheet">
    <link rel="stylesheet" href="~/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/animate.css" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.icons8.com/fonts/line-awesome/1.1/css/line-awesome-font-awesome.min.css">
    <link rel="shortcut icon" href="images/favicon.ico">
    <!-- Owl Stylesheets -->
    <link rel="stylesheet" href="~/css/owl.carousel.min.css">
    <link rel="stylesheet" href="~/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="~/css/bootstrap-multiselect.css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="~/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="~\css/scroll.css">

</head>

<body oncontextmenu="return false;">

    <header>

        <div class="container">
            <div class="row">

                <div class="col-md-4"><div class="logo"><a href="/"><img src="~/images/logo.png" alt=""></a></div></div>
                <div class="col-md-8 ml-auto">
                    <div class="top-con-bar">
                        <div class="row justify-content-end">

                            <div class="col-sm-3">
                                <div class="icon"><i class="fa fa-phone"></i></div>
                                <div class="top-bt-txt">
                                    <h4>Telephone</h4>
                                    <p>@headerData.PhoneNumber</p>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="icon"><i class="fa fa-envelope"></i></div>
                                <div class="top-bt-txt">
                                    <h4>Email Address</h4>
                                    <p>@headerData.EmailAddress </p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>


            </div>
        </div>

        <div class="main-nav">
            <div class="container">
                <nav class="navbar navbar-expand-lg p-0" id="mainNav">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation"><span class="fa fa-bars 2x"></span> Menu</button>
                    <div class="collapse navbar-collapse" id="navbarNavDropdown">
                        <ul class="navbar-nav">
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("MarketAnalysisChart", "MarketAnalysis")">Market Analysis </a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("ChecmPriceChart", "ChemicalPricing")">Chemical Pricing</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("Reportsection", "Industry")">Industry Reports</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("CompanyProfile", "Company")">Company Profile</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("NewsHome", "NewsAndDeals")">News</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("DealsHome", "NewsAndDeals")">Deals</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("Contact", "ChemAnalyst")">Contact Us</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("FreeTrail", "ChemAnalyst")"> Free Trial</a> </li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("Index", "Login")"><i class="fa fa-user"></i> Login</a></li>
                            <li class="nav-item"><a class="nav-link" href="@Url.Action("Index", "ChemAnalyst")"><i class="fa fa-home"></i> Home</a></li>
                        </ul>
                    </div>

                </nav>
            </div>
        </div>

    </header>

    <div class="inner-banner">
        <img src="images/about-banner.jpg">
        <h1>Market Analysis</h1>

        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Market Analysis</li>
        </ol>

    </div>


    <div class="page-content">
        <div class="static-page">
            <div class="container">



                <div class="row">

                    <div class="col-md-9">

                        <div class="common-desc">
                            <p style="text-justify:auto; line-height:25px; font-size:1rem">Access in-depth demand and supply for more than 175 chemicals and petrochemicals bifurcated by capacity, production, demand-supply gap, foreign trade, operating efficiency, company shares, revenues by application, sales channel and regions in the Indian market. Accurate and unbiased data provides you a 360° view of the market with historical and forecast sales data which will not only enable you to stay informed about the new developments in the market but will help you plan your future strategies. </p>
                        </div>

                        <div class="filter-chart-type">
                            @using (Html.BeginForm("ShowChart", "MarketAnalysis", null, FormMethod.Post, new { @id = "ShowChart", enctype = "multipart/form-data" }))
                            {
                                <div class="row">
                                    <div class="col-md-4 mt10">
                                        <p><i class="fa fa-bars"></i> Category</p>
                                        @Html.DropDownList("category", new SelectList(ViewBag.ProductList, "Value", "Text"), "Please Select Category", new { @id = "category", @class = "btn btn-primary width100", required = "required", oninvalid = "this.setCustomValidity('Please Select Category')", onchange = "try{setCustomValidity('')}catch(e){}" })


                                    </div>
                                    <div class="col-md-4 mt10">
                                        <p><i class="fa fa-list"></i> Product</p>
                                        <select class="btn btn-primary width100" id="ddlProduct" name="ddlProduct" required="required" oninvalid="this.setCustomValidity('Please select product')" onchange="try{setCustomValidity('')}catch(e){}"></select>
                                    </div>

                                    <div class="col-md-4 mt10">
                                        <p><i class="fa fa-random"></i> Analysis Parameters</p>
                                        <select id="ddlRange" name="ddlRange" class="btn btn-primary width100" required="required" oninvalid="this.setCustomValidity('Please Select File Type')" onchange="try{setCustomValidity('')}catch(e){}">
                                            <option value="">Select File Type</option>
                                            <option value="Company" selected>Capacity By Company</option>
                                            <option value="Location">Capacity By Location</option>
                                            <option value="Technology">Capacity By Technology</option>
                                            <option value="Process">Capacity By Process</option>
                                            <option value="Production">Production By Company</option>
                                            <option value="Operating Efficiency">Operating Efficiency</option>
                                            @*<option value="Demand By EndUse(%)">Demand By EndUse(%)</option>*@
                                            <option value="Demand By EndUse(T)">Demand By End Use</option>
                                            @*<option value="Demand By Grade(%)">Demand By Grade(%)</option>*@
                                            <option value="Demand By Grade(T)">Demand By Grade</option>
                                            @*<option value="Demand By Type(%)">Demand By Type(%)</option>*@
                                            <option value="Demand By Type(T)">Demand By Type</option>
                                            <option value="Demand By SalesChannel(T)">Demand By Sales Channel</option>
                                            @*<option value="Demand By SalesChannel(%)">Demand By SalesChannel(%)</option>*@
                                            @*<option value="Demand By GradePricing">Demand By GradePricing</option>*@
                                            <option value="Demand By Region(T)">Demand By Region</option>
                                            @*<option value="Demand By Region(%)">Demand By Region(%)</option>*@
                                            <option value="Demand By TradeExport">Country-wise Export</option>
                                            <option value="Demand By TradeImport">Country-wise Import</option>
                                            <option value="Demand Supply Gap">Demand-Supply Gap</option>
                                            <option value="Demand By CompanyShares(T)">Company Share</option>
                                            @*<option value="Demand By CompanyShares(%)">Demand By CompanyShares(%)</option>*@
                                        </select>

                                    </div>

                                    <div class="col-md-4  mt10">
                                        <p><i class="fa fa-bar-chart"></i> Chart Types</p>
                                        <select class="btn btn-primary width100" id="ddlChart" name="ddlChart">
                                            <option value="line">Line Chart</option>
                                            <option value="bar">Bar Chart</option>
                                            @*<option value="pie">Pie Chart</option>*@
                                        </select>
                                    </div>
                                    <div class="col-md-4  mt10">
                                        <p><i class="fa fa-bar-chart"></i> From Year</p>
                                        <select class="btn btn-primary width100" id="ddlFyear" name="ddlFyear">
                                            <option value="0">Select From</option>
                                            <option value="2016">2016</option>
                                            <option value="2017">2017</option>
                                            <option value="2018">2018</option>
                                            <option value="2019">2019</option>
                                            <option value="2020">2020</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4  mt10">
                                        <p><i class="fa fa-bar-chart"></i> To Year</p>
                                        <select class="btn btn-primary width100" id="ddlToYear" name="ddlToYear" >
                                            <option value="0">Select To</option>
                                            <option value="2016">2016</option>
                                            <option value="2017">2017</option>
                                            <option value="2018">2018</option>
                                            <option value="2019">2019</option>
                                            <option value="2020">2020</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4 mt10" style="display:none">
                                        <p>
                                            <i class="fa fa-compress"></i> Comparision
                                        </p>
                                        <select name="example-getting-started" id="example-getting-started" class="btn btn-primary width100" multiple="multiple"> </select>
                                        <option selected="selected" value="xyz">Xyz</option>
                                        <option selected="selected" value="pqr">Pqr</option>
                                        <option value="lmn">Lmn</option>


                                    </div>

                                    <div class="col-md-4 pl-0 mt10" style="margin-left: 15px;">
                                        <button type="submit" onclick="SubmitForm()" class="btn btn-green mt27">
                                            <i class="fa fa-refresh"></i>
                                            Vew Chart
                                        </button>
                                    </div>
                                </div>
                            }
                        </div>


                        <div class="filter-checkbox-btn">


                            <ul>

                                <span> <b>There is no data available with selected range.</b></span>

                            </ul>

                        </div>





                    </div>


                    <div class="col-md-3">
                        <aside>
                            <h3><i class="fa fa-bell-o"></i> News <a href="@Url.Action("NewsHome","NewsAndDeals")" class="pull-right" style="font-size: 14px; margin-top: 4px; color:#fff">View all</a></h3>
                            <div class="side-news-feed">
                                @foreach (var news in Model.NewsList)
                                {
                                    <div class="news-feed-col">
                                        <a style="font-size: 14px;font-weight: 600;" href="@Url.Action("NewsDetails", "NewsAndDeals", new { id = news.GenerateItemNameAsParam() })">
                                            @{

                                                <span>
                                                    @Html.Raw(WebUtility.HtmlDecode(news.NewsName))
                                                </span>


                                            }


                                            <div class="right-news-desc2" style="font-size:14px">
                                                <br />
                                                <p><i class="fa fa-calendar-o"></i>@news.CreatedTime.ToString("MMM/yyyy")</p>
                                            </div>
                                        </a>

                                    </div>

                                }
                            </div>
                            <div class="mt-4">
                                <h3><i class="fa fa-thumbs-up"></i> Top Deals <a href="@Url.Action("DealsHome","NewsAndDeals")" class="pull-right" style="font-size: 14px; margin-top: 4px; color:#fff">View all</a></h3>
                                <div class="side-news-feed" style="">
                                    @foreach (var item in Model.DealList)
                                    {
                                    <div class="news-feed-col">
                                        <a style="font-size: 14px;font-weight: 600;" href="@Url.Action("DealsDetails", "NewsAndDeals", new { id = item.GenerateItemNameAsParam() })">
                                            @{

                                                <span>
                                                    @Html.Raw(WebUtility.HtmlDecode(item.DealsName))
                                                </span>


                                            }
                                            <div class="right-news-desc2">
                                                <br />
                                                <p><i class="fa fa-calendar-o"></i>@item.CreatedTime.Value.ToString("MMM/yyyy")</p>
                                            </div>
                                        </a>

                                    </div>
                                    }
                                </div>
                                </div>
</aside>
                    </div>



                </div>

            </div>
        </div>
    </div>


    <!-- The Modal -->
 
		   <div class="modal" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content login-pic">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="login-pic">
                                <div class="freeSub">
                                    <h2 style="color:black">Get Market Analysis in few-clicks.</h2>
                                     <a target="_blank" href="@Url.Action("FreeTrail", "ChemAnalyst")" class="btn btn-yellow">Subscribe Today</a>
                                    <a href="~/MarketAnalysis/MarketbycompanyChart?Range=Company&Customer=False" class="btn btn-yellow">Go Back</a>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container-fluid">
            <div class="footer-bottom">
                <div class="row">
                    <div class="col-lg-4">
                        <p>
                            <table>
                                <tr><a href="#"><i class="fa fa-twitter" style="font-size:27px;color:white"></i></a></tr>
                                <tr><a href="#"><i class="fa fa-facebook" style="font-size:27px;color:white"></i></a></tr>
                                <tr><a href="#"><i class="fa fa-linkedin" style="font-size:27px;color:white"></i></a></tr>
                            </table>
                        </p>

                    </div>
                    <div class="col-lg-2">
                        <div class="foot-links">
                            <p><a href="@Url.Action("AboutUs", "ChemAnalyst")">About Us</a></p>

                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="foot-links">
                            <p><a href="@Url.Action("Faq", "ChemAnalyst")">FAQs</a></p>
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="foot-links">
                            <p><a href="@Url.Action("Privacypolicy", "ChemAnalyst")">Privacy Policy</a></p>

                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="foot-links">

                            <p><a href="@Url.Action("Terms", "ChemAnalyst")">Terms &amp; Conditions</a></p>
                        </div>
                    </div>
                </div>
                <div class="copyright text-center">
                    <p>Copyright 2019. Chem Analyst. All Rights Reservered. </p>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="~/js/popper.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/bootstrap-multiselect.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.min.js"></script>

    <script src="~/js/owl.carousel.js"></script>
    <script src="~/js/wow.min.js"></script>
    <script src="~/js/honey-custom.js"></script>
    <script src="~/js/Chart.min.js"></script>
    <script src="~/js/utils.js"></script>
    <script>
        $(document).ready(function () {

            $("#ddlProduct").change(function () {
                debugger;
                var ProductId = $(ddlProduct).find("option:selected").val();

                $.ajax({
                    type: "POST",
                    url: "../MarketAnalysis/CheckAccess",
                    data: "{ ProductId:" + ProductId + "}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        debugger;
                        if (response == "Access") {

                        }
                        else {
                            $('#myModal').modal({ backdrop: 'static', keyboard: false });
                            event.preventDefault();
                        }
                    },
                    failure: function (response) {
                        // alert(response.responseText);
                    },
                    error: function (response) {
                        // alert(response.responseText);
                    }
                });
            });
            var range = $(ddlRange).find("option:selected").val();
            var ddlCustomers = $("#ddlChart");

            if (range == "Demand By TradeExport" || range == "Demand By TradeImport") {
                ddlCustomers.empty().append('<option selected="selected" value="line" >Line Chart</option><option value="bar" >Bar Chart</option>');
            }
            else if (range == "Demand By CompanyShares(T)") {
                ddlCustomers.empty().append('<option selected="selected" value="pie" >Pie Chart</option>');
            }
            else if (range == "Demand Supply Gap") {
                ddlCustomers.empty().append('<option selected="selected" value="line" >Line Chart</option>');
            }
            else {
                ddlCustomers.empty().append('<option selected="selected" value="line" >Line Chart</option><option value="bar" >Bar Chart</option>');
            }
        });

    </script>
    <script>
        function SubmitForm() {
            var Product = @Html.Raw(Product);

            //  $('#ddlProduct').val();
            if ( $('#ddlProduct').val()===Product)// Calling validation function
            {

                    document.getElementById("ShowChart").submit(); //form submission

            }
            else
            {
                $('#myModal').modal({backdrop: 'static', keyboard: false});

            }
        }
        $("body").on("change", "#category", function () {
            var CatId=$(category).find("option:selected").val();

            var ddlCustomers = $("#ddlProduct");
            //  var ddlCompare = $("#example-getting-started");
            // example-getting-started
            ddlCustomers.empty().append('<option selected="selected" value="" disabled = "disabled">Loading.....</option>');

            $.ajax({
                type: "POST",
                url: "../MarketAnalysis/GetProductName",
                data: "{ CatId:"+ CatId +"}" ,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                success: function (response) {
                    ddlCustomers.empty().append('<option selected="selected" value=""> select Product</option>');
                    //ddlCompare.empty().append('<option selected="selected" value="0"> select Product</option>');

                    $.each(response, function () {
                        ddlCustomers.append($("<option></option>").val(this['Value']).html(this['Text']));
                        // ddlCompare.append($("<option  ></option>").val(this['Value']).html(this['Text']));

                    });
                    $("#example-getting-started").multiselect();
                    // alert("category call");
                },
                failure: function (response) {
                  //  alert(response.responseText);
                },
                error: function (response) {
                   // alert(response.responseText);
                }
            });
        });

        $("body").on("change", "#ddlRange", function () {
            debugger
            var rangeId=$(ddlRange).find("option:selected").val();

            var ddlFyear = $("#ddlFyear");
            var ddlToYear = $("#ddlToYear");
            //  var ddlCompare = $("#example-getting-started");
            // example-getting-started
            ddlFyear.empty().append('<option selected="selected" value="" disabled = "disabled">Loading.....</option>');
            ddlToYear.empty().append('<option selected="selected" value="" disabled = "disabled">Loading.....</option>');
            $.ajax({
                type: "POST",
                url: "../MarketAnalysis/GetUniqueYears",
                //data: "{ rangeId:"+ rangeId +"}" ,
                data: JSON.stringify({'rangeId':rangeId}),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                success: function (response) {
                    debugger
                    ddlFyear.empty().append('<option selected="selected" value=""> Select From</option>');
                    ddlToYear.empty().append('<option selected="selected" value=""> Select To</option>');
                    $.each(response, function () {
                        ddlFyear.append($("<option></option>").val(this['Value']).html(this['Text']));
                        ddlToYear.append($("<option></option>").val(this['Value']).html(this['Text']));

                    });
                    //$("#example-getting-started").multiselect();
                    // alert("category call");
                },
                failure: function (response) {
                    // alert(response.responseText);
                },
                error: function (response) {
                    // alert(response.responseText);
                }
            });

            debugger
            var range = $(ddlRange).find("option:selected").val();
            var ddlCustomers = $("#ddlChart");

            if (range == "Demand By TradeExport" || range == "Demand By TradeImport") {
                ddlCustomers.empty().append('<option selected="selected" value="line" >Line Chart</option><option value="bar" >Bar Chart</option>');
            }
            else if(range=="Demand By CompanyShares(T)") {
                ddlCustomers.empty().append('<option selected="selected" value="pie" >Pie Chart</option>');
            }
            else if(range=="Demand Supply Gap") {
                ddlCustomers.empty().append('<option selected="selected" value="line" >Line Chart</option>');
            }
            else {
                ddlCustomers.empty().append('<option selected="selected" value="line" >Line Chart</option><option value="bar" >Bar Chart</option>');
            }
        });

          window.onload = function () {

                        var Product = @Html.Raw(Product);
                        var ChartType = @Html.Raw(ChartType);
                        var range = @Html.Raw(range);
                        var Category = @Html.Raw(Category);

                        $('#category').val(Category).trigger('change');


                        $('#ddlProduct').val(Product);
                        $('#ddlChart').val(ChartType);
                        $('#ddlRange').val(range);

                    };
        $.validate({
            validateOnBlur : false, // disable validation when input looses focus
            errorMessagePosition : 'top', // Instead of 'inline' which is default
            scrollToTopOnError : false // Set this property to true on longer forms
        });
        $(document).ready(function () {
            $("#Chemprice").validate({
                debug: true,
                rules: {
                    ddlProduct: {
                        required: function () {
                            if ($("#ddlProduct option[value='0']")) {
                                return true;
                            } else {
                                return false;
                            }
                        }
                    },
                    ddlChart: {
                        required: function () {
                            if ($("#ddlChart option[value='0']")) {
                                return true;
                            } else {
                                return false;
                            }
                        }
                    }, ddlRange: {
                        required: function () {
                            if ($("#ddlRange option[value='0']")) {
                                return true;
                            } else {
                                return false;
                            }
                        }
                    }
                },
                messages: {
                    ddlRange: "range Required",
                },
            });
        })
    </script>

</html>